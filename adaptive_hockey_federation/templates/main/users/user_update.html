{% extends "base/base.html" %}
{% load static %}
{% load user_filters %}
{% block title %}
   Редактирование пользователя {{ object.first_name }} {{ object.last_name }}
{% endblock %}
{% block content %}
<div class="card update_card">
  <h4 class="card-header">
    Редактирование пользователя {{ object.first_name }} {{ object.last_name }}
  </h4>
  <div class="card-body">
    <form method="post"
    {% if action_url %}
      action="{% url action_url %}"
      enctype="multipart/form-data"
    {% endif %}>
      {% csrf_token %}
      {% for field in form %}
      <div class="row my-3">
        <label for="{{ field.id_for_label }}">
          {{ field.label }}
            {% if field.field.required %}
              <span class="required text-danger">*</span>
            {% endif %}
        </label>
        {{ field |addclass:'form-control' }}
      {% if field.errors %}
      <small class="error">{{ field.errors|striptags  }}</small>
    {% endif %}
      </div>
      {% endfor %}
      <button type="submit" class="update_btn">
        Сохранить
      </button>
    </form>
  </div>
</div>
{% comment %} <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script> {% endcomment %}
<script type="text/javascript">
  document.addEventListener("DOMContentLoaded", function () {
      var roleSelect = document.getElementById("id_role");
      var teamSelectContainer = document.getElementById("id_team");
      var teamContainer = document.querySelector("label[for='id_team']");

      function toggleTeamSelect() {
          var role = roleSelect.value;
          // Меняем свойство display в зависимости от выбранной роли
          // 'moderator' заменяем на значение value вашего селекта для модератора
          if(role === "Модератор" || role === "Администратор") {
              teamSelectContainer.style.display = "none";
              teamSelectContainer.value = "";
              teamContainer.style.display = "none";
          } else {
              teamSelectContainer.style.display = "block";
              teamContainer.style.display = "block";
          }
      }

      // Вызываем функцию при изменении значения селекта роли
      roleSelect.addEventListener("change", toggleTeamSelect);

      // И при загрузке страницы тоже неплохо бы проверить и скрыть/показать поле если надо
      toggleTeamSelect();
  });
  </script>
{% endblock %}
